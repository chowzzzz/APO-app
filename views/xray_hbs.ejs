<% include partials/header %>
<% include partials/nav %>
<%
function UNIXConverter(UNIX_timestamp){
  try {
    if (UNIX_timestamp == 0) {
      return "";
    }
    var a = new Date(UNIX_timestamp * 1000);
    var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    var year = a.getFullYear();
    var month = a.getMonth() + 1;
    var date = a.getDate();
    var hour = a.getHours();
    var min = a.getMinutes();
    var sec = a.getSeconds();
    var time = date + '/' + month + '/' + year;
    return time;
  } catch (error) {
    return "";
  }
}
%>
<div class="container-fluid">

  <h4 class="mt-4">Xray HBS -
    <%=officer_details.nric%>
  </h4>
  <hr>

  <ul class="nav nav-tabs mb-4">
    <li class="nav-item">
      <a class="nav-link" href="/access_control/<%=officer_details.nric%>">AC</a>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="/general_screener/<%=officer_details.nric%>">GS</a>
    </li>
    <li class="nav-item dropdown">
      <a class="nav-link active dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
        aria-expanded="false">Xray</a>
      <div class="dropdown-menu">
        <a class="dropdown-item" href="#">Xray HBS</a>
        <a class="dropdown-item" href="/xray_pb/<%=officer_details.nric%>">Xray PB</a>
        <a class="dropdown-item" href="/xray_cargo/<%=officer_details.nric%>">Xray Cargo</a>
      </div>
    </li>
    <li class="nav-item dropdown">
      <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true"
        aria-expanded="false">ST & SB</a>
      <div class="dropdown-menu">
        <a class="dropdown-item" href="#">Security Test</a>
        <a class="dropdown-item" href="#">Security Breach</a>
      </div>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">Others</a>
    </li>
  </ul>

  <table class="table table-hover table-bordered table-striped table-responsive-sm col-sm-10 mx-auto pl-0 mb-4">
    <thead class="thead-light">
      <tr>
        <th>#</th>
        <th>Status</th>
        <th>Certified Date</th>
      </tr>
    </thead>
    <% if (xray_hbs_details == null) { %>
    <tr>
      <td class="mx-auto text-danger" colspan="3">Officer does not have any existing certificates.</td>
    </tr>
    <% } %>

    <% var i = 1 %>
    <% for (var xray_hbs_id in xray_hbs_details) { %>
    <% var status; %>
    <tr class='clickable-row' data-href='/xray_hbs/<%=officer_details.nric%>/<%=xray_hbs_id%>'>
      <td>
        <%=i%>
        <% i++ %>
      </td>
      <% if (xray_hbs_details[xray_hbs_id].overall_status == "1") { %>
      <td>
        PASS
      </td>
      <% } else { %>
      <td class="text-danger">
        FAIL
      </td>
      <% } %>
      <td>
        <%=UNIXConverter(xray_hbs_details[xray_hbs_id].certified_date)%>
      </td>
    </tr>
    <% } %>
  </table>

  <div class="mb-4 col-11 mx-auto">
    <% if (user.role == 1) { %>
    <a href="/xray_hbs/new/<%=officer_details.nric%>" class="btn btn-primary col-sm-6">Add New Record</a>
    <% } %>

  </div>
</div>

<% include partials/footer %>